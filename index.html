<!-- Bas script part change kiya hai -->

<script>
function openChat() {
  document.getElementById('chatWindow').style.display = 'flex';
  document.getElementById('chatBubble').style.display = 'none';
}
function closeChat() {
  document.getElementById('chatWindow').style.display = 'none';
  document.getElementById('chatBubble').style.display = 'block';
}

const faqs = {
  "sip": "SIP ka matlab hai Systematic Investment Plan, jisme aap fixed amount regular invest karte hain.",
  "mutual fund": "Mutual fund me log apna paisa ek saath lagate hain aur expert usse manage karta hai.",
  "growfin": "GrowFin Wealth SIP planning, mutual funds, retirement aur goal planning me madad karta hai.",
  "elss": "ELSS tax saving mutual fund hai jisme 3 saal ka lock-in period hota hai aur tax benefit milta hai.",
  "goal planning": "Goal Planning ke liye humein sahi amount aur duration define karna hota hai.",
  "investment": "Investment ek important financial decision hai. Planning zaroori hai!"
};

function sendMessage() {
  let input = document.getElementById("userInput");
  let userText = input.value.trim();
  if (!userText) return;
  addMessage(userText, "user");
  input.value = "";

  botThinking();

  setTimeout(() => {
    let reply = smartReply(userText);
    removeThinking();
    botReply(reply.text);
    if (reply.showCalculator) showCalculatorButton();
    if (reply.showContact) showKnowMoreButton();
  }, 400);
}

function smartReply(text) {
  let lowerText = text.toLowerCase();
  let response = { text: "üôè Maaf kijiye, mujhe iske baare me jaankari nahi hai.", showCalculator: false, showContact: false };

  // Sabse pehle "calculator" word check
  if (lowerText.includes("calculator")) {
    response.text = "Aap apne investment planning ke liye Calculator ka use kar sakte hain! üìà";
    response.showCalculator = true;
    return response;
  }

  // FAQ based simple reply
  for (let key in faqs) {
    if (lowerText.includes(key)) {
      response.text = faqs[key];
      return response;
    }
  }

  // Contact info
  if (lowerText.includes('contact') || lowerText.includes('details') || lowerText.includes('jaankari') || lowerText.includes('form')) {
    response.text = "Aap humse contact kar sakte hain! üìû";
    response.showContact = true;
  }

  return response;
}

function botThinking() {
  addMessage("FinFlora soch rahi hai...", "bot typing");
}

function removeThinking() {
  const messages = document.getElementById("messages");
  const lastMessage = messages.lastChild;
  if (lastMessage && lastMessage.classList.contains("typing")) {
    messages.removeChild(lastMessage);
  }
}

function botReply(text) {
  addMessage(text, "bot");
}

function addMessage(text, sender) {
  const messages = document.getElementById("messages");
  const div = document.createElement("div");
  div.className = "message " + sender;
  if (sender === "bot typing") {
    div.className = "message bot typing";
  }
  div.innerText = text;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}

function showCalculatorButton() {
  const quickReplies = document.getElementById("quickReplies");
  quickReplies.innerHTML = "";
  quickReplies.style.display = 'flex';

  const btn = document.createElement("button");
  btn.className = "icon-button";
  btn.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/833/833472.png" alt="Calculator Icon"> Calculator Dekhein`;

  btn.onclick = () => {
    botReply("Yeh raha aapka Calculator! üìä");
    alert('Calculator section dikhana hai!');
    quickReplies.style.display = 'none';
  };
  quickReplies.appendChild(btn);
}

function showKnowMoreButton() {
  const quickReplies = document.getElementById("quickReplies");
  quickReplies.innerHTML = "";
  quickReplies.style.display = 'flex';

  const btn = document.createElement("button");
  btn.className = "icon-button";
  btn.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/1828/1828817.png" alt="Info Icon"> Contact aur Details`;

  btn.onclick = () => {
    botReply("Aap hume contact kar sakte hain ya form bhar sakte hain! ‚ú®");
    alert('Contact ya form section dikhana hai!');
    quickReplies.style.display = 'none';
  };
  quickReplies.appendChild(btn);
}

document.getElementById("userInput").addEventListener("keypress", function(e) {
  if (e.key === "Enter") {
    sendMessage();
  }
});
</script>
